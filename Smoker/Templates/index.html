{% load staticfiles %}
<!DOCTYPE html>
<html>
	<head>
		<link href="https://fonts.googleapis.com/css?family=Bangers" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css?family=Orbitron" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css?family=Coming+Soon" rel="stylesheet">
		<script src="{% static 'js/jquery-3.1.1.min.js' %}"></script>
		<script src="{% static 'js/bootstrap.min.js' %}"></script>
		<script src="{% static 'js/script.js' %}"></script>
		<link rel="stylesheet" href="{% static 'css/main.css' %}">
		<link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
		<title>FUMADOR</title>
	</head>

	<body>
	<form action="{% url 'serviceView' %}" method="POST" id="form" name="form">

		<div align="center">
			<h1 class="titulo vinotinto" style="font-size: 46pt">SMOKER</h1>
			<img src="../static/iconos/smoker.png">
      <hr>          <!--  ESPACIO CON LINEA -->
		</div>
			<center> 
					<div class="col-md-12">
						<div class="col-md-2"></div>
						<div class="col-md-8">
									<input type="text" id="listTask" class="form-control subtitulo" style="text-align:center;color:purple;font-size: 12px;" id="" placeholder="Feedback Web Service"  >
						</div>
						<div class="col-md-2"></div>
					</div>
					<br><br>
  			</center>
  				<hr>       <!--  ESPACIO CON LINEA -->
  			<center>
  					<button type="button" style="background-color: #4C1B1B" class="btn btn-primary btn-lg subtitulo bench col-md-4" id="MATCH"    value="MATCH"   onclick="serviceView('MATCH')"> BENCH MATCH </button>
  					<button type="button" style="background-color: #4C1B1B" class="btn btn-primary btn-lg subtitulo bench col-md-4" id="PAPER"    value="PAPER"   onclick="serviceView('PAPER')"> BENCH PAPER </button>
  					<button type="button" style="background-color: #4C1B1B" class="btn btn-primary btn-lg subtitulo bench col-md-4" id="TOBACCO"  value="TOBACCO" onclick="serviceView('TOBACCO')"> BENCH TOBACCO </button>
  			</center>
			  &nbsp;      <!--  PARA ESPACIOS  -->
          &nbsp;      <!--  PARA ESPACIOS  -->
          &nbsp;      <!--  PARA ESPACIOS  -->  
			  <center> 
  					<button type="button" style='width:10%' class="subtitulo btn btn-primary btn-lg btn-block-center btn-lg active"   id="SMOKE"    value="SMOKE"    onclick="serviceView('SMOKE')"> ¡ SMOKE ! </button>
  			</center>
			  hr
          &nbsp;      <!--  PARA ESPACIOS  -->
          &nbsp;      <!--  PARA ESPACIOS  -->
          &nbsp;      <!--  PARA ESPACIOS  -->  
  			<center>
  					<button type="button" style="width: 33%; background-color:#BD8D46" class="btn btn-default btn-lg subtitulo negro btn-block-center"   id="XML"      value="XML"     onclick="serviceView('XML')"> VIEW XML </button>
        </center>
		&nbsp;      <!--  PARA ESPACIOS  -->
        &nbsp;      <!--  PARA ESPACIOS  -->
        &nbsp;      <!--  PARA ESPACIOS  -->  
		<div class="col-md-12">
			<div class="col-md-6">
				<br><br><div id="listTask" style="color:purple;font-size: 12px;">
                        
                 </div><br><br>
			</div>
			<div class="col-md-6" id="div_xml">
			</div>
		</div>
          &nbsp;      <!--  PARA ESPACIOS  -->  
		<div class="col-md-12">
			<div class="col-md-4">
				
			</div>
			<div class="col-md-4" id="div_xml">
			</div>
			<div class="col-md-4">
				
			</div>
		</div>
  		 <hr>
          &nbsp;      <!--  PARA ESPACIOS  --> 
          &nbsp;      <!--  PARA ESPACIOS  --> 
          &nbsp;      <!--  PARA ESPACIOS  --> 
  			<center>

  					<button type="button" style="background-color:#B9121B" class="btn btn-primary  btn-lg subtitulo negro col-md-12" onclick="serviceView('REPLICATE')"> ¿ Generate Replica ? </button>

  			</center>
  				&nbsp;      <!--  PARA ESPACIOS  -->
  				&nbsp;      <!--  PARA ESPACIOS  -->
  				&nbsp;      <!--  PARA ESPACIOS  -->
  				&nbsp;      <!--  PARA ESPACIOS  -->

  				<center>
  					<hr>
  					<hr>
  					<button type="button" style='width:20%' class="subtitulo btn btn-primary btn-lg btn-block-center btn-lg active" onclick="serviceView('RESTORE')"> ¡ RESTORE XML ! </button>
  				</center>
            <hr>
            <hr>
            <hr>
			<input id="action"            name="action"            type="text" value=""                        style="display:none">
            <input id="HTML_ELEMENT_XML"  name="HTML_ELEMENT_XML"  type="text" value="{{ HTML_ELEMENT_XML }}"  style="display:none">
            <input id="HTML_REQUEST"      name="HTML_REQUEST"      type="text" value="{{ HTML_REQUEST }}"      style="display:none">
			
			{% if MATCH == 'NOOK' %}   
				<script> document.getElementById("MATCH").disabled = false;  </script>   
			{% else %}
				<script> document.getElementById("MATCH").disabled = true;  </script>
			{% endif %}

			{% if PAPER == 'NOOK' %}   
				<script> document.getElementById("PAPER").disabled = false;  </script>   
			{% else %}
				<script> document.getElementById("PAPER").disabled = true;  </script>
			{% endif %}

			{% if TOBACCO == 'NOOK' %}   
				<script> document.getElementById("TOBACCO").disabled = false;  </script>   
			{% else %}
				<script> document.getElementById("TOBACCO").disabled = true;  </script>
			{% endif %}

			{% if MATCH == 'OK' and PAPER == 'OK' and TOBACCO == 'OK' %}   
				<script> document.getElementById("SMOKE").disabled = false;  </script>   
			{% else %}
				<script> document.getElementById("SMOKE").disabled = true;  </script>
			{% endif %}
			<script>
				str = document.getElementById("HTML_REQUEST").value;
				formatRequest(str);
				xml_raw = document.getElementById("HTML_ELEMENT_XML").value;
				xml_formatted = formatXml(xml_raw);
				xml_escaped = xml_formatted.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/ /g, '&nbsp;').replace(/\n/g,'<br />');
				var mydiv = document.createElement('div');
				mydiv.innerHTML = xml_escaped;
				document.getElementById("div_xml").appendChild(mydiv);
			</script>
	</form>
	<!-- *********************************************************************** -->
	<!-- *********************************************************************** -->
	<!-- *********************************************************************** -->
	<div class="modal fade" id="miVentana" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="exampleModalLabel">Aceptar Replica?</h5>
			</div>
			<div class="modal-body">
				<p>Desea Aceptar la replica?</p>
			</div>
			<div class="modal-footer">
				<button id="btn-aceptar" type="button" class="btn btn-secondary" data-dismiss="modal">Aceptar</button>
				<button id="btn-cancelar" type="button" class="btn btn-primary" data-dismiss="modal">Cancelar</button>
			</div>
			</div>
		</div>
	</div>
	<script>	
		$('#btn-aceptar').click(function() {
			request = $.ajax({
				url: "{% url 'aceptar' %}",
				type: "get",
				data: ""
			});
			request.done(function (response, textStatus, jqXHR){
				console.log(response['VIEW_MODAL']);
				if (response['VIEW_MODAL']) {
					$('#miVentana').modal('show')
				}
			});
			
			request.fail(function (jqXHR, textStatus, errorThrown){
				console.error("Error: "+textStatus, errorThrown);
			});
		});

		$('#btn-cancelar').click(function() {
			request = $.ajax({
				url: "{% url 'cancelar' %}",
				type: "get",
				data: ""
			});
			request.done(function (response, textStatus, jqXHR){
				console.log(response['VIEW_MODAL']);
				if (response['VIEW_MODAL']) {
					$('#miVentana').modal('show')
				}
			});
			
			request.fail(function (jqXHR, textStatus, errorThrown){
				console.error("Error: "+textStatus, errorThrown);
			});
		});
	</script>

	{% if VIEW_MODAL %}
		<script>
			$('##miVentana').modal('show');
		</script>
	{% endif %}
	<script>
		function update() {
			request = $.ajax({
				url: "{% url 'update_view' %}",
				type: "get",
				data: ""
			});
			request.done(function (response, textStatus, jqXHR){
				console.log(response['VIEW_MODAL']);
				if (response['VIEW_MODAL']) {
					$('#miVentana').modal('show')
				}
			});
			
			request.fail(function (jqXHR, textStatus, errorThrown){
				console.error("Error: "+textStatus, errorThrown);
			});
		}
		
		setInterval("update()",5000);

	</script>



	<!-- *********************************************************************** -->
	<!-- *********************************************************************** -->
	<!-- *********************************************************************** -->
	</body>


</html>
